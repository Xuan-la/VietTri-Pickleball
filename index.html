<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω CLB Pickleball - T√≠nh Ti·ªÅn</title>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js"></script>
    <style>
        :root {
            --color-primary: #208791;
            --color-primary-hover: #186e7e;
            --color-primary-active: #157170;
            --color-text: #134252;
            --color-text-secondary: #626c7c;
            --color-bg: #fcfcf9;
            --color-surface: #fffffe;
            --color-border: rgba(94, 82, 64, 0.2);
            --color-success: #22c75a;
            --color-error: #c0152f;
            --color-warning: #a84b2f;
            --color-green: #22c75a;
            --color-red: #ff5459;
            --radius: 8px;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.06);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            padding: 16px;
            line-height: 1.5;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--color-primary);
        }

        header h1 {
            font-size: 24px;
            color: var(--color-primary);
            margin-bottom: 4px;
        }

        header p {
            color: var(--color-text-secondary);
            font-size: 14px;
        }

        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--color-border);
            overflow-x: auto;
        }

        .tab-btn {
            padding: 12px 16px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--color-text-secondary);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 150ms;
            white-space: nowrap;
        }

        .tab-btn.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 16px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: var(--color-text);
        }

        input, select, textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius);
            font-size: 14px;
            font-family: inherit;
            color: var(--color-text);
            background: var(--color-surface);
            transition: border-color 150ms;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(32, 135, 145, 0.15);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            width: 100%;
            padding: 12px 16px;
            background: var(--color-primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 150ms;
            margin-top: 8px;
        }

        .btn:hover {
            background: var(--color-primary-hover);
        }

        .btn:active {
            background: var(--color-primary-active);
        }

        .btn-small {
            width: auto;
            padding: 6px 12px;
            font-size: 12px;
            margin: 0;
        }

        .match-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 16px;
        }

        .match-item {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius);
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .match-info {
            flex: 1;
        }

        .match-players {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .match-score {
            font-size: 12px;
            color: var(--color-text-secondary);
        }

        .delete-btn {
            background: var(--color-error);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background 150ms;
        }

        .delete-btn:hover {
            background: #a0121f;
        }

        .ranking-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
            box-shadow: var(--shadow-sm);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .ranking-table thead {
            background: var(--color-primary);
            color: white;
        }

        .ranking-table th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .ranking-table td {
            padding: 12px;
            border-bottom: 1px solid var(--color-border);
            font-size: 14px;
        }

        .ranking-table tbody tr {
            background: var(--color-surface);
            transition: background 150ms;
        }

        .ranking-table tbody tr:hover {
            background: rgba(32, 135, 145, 0.05);
        }

        .rank-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            background: var(--color-primary);
            color: white;
            border-radius: 50%;
            font-weight: 600;
            font-size: 14px;
        }

        .rank-1 { background: #ffd700; color: #333; }
        .rank-2 { background: #c0c0c0; color: #333; }
        .rank-3 { background: #cd7f32; color: white; }

        .win { color: var(--color-success); font-weight: 600; }
        .loss { color: var(--color-error); font-weight: 600; }

        .money {
            font-weight: 600;
            font-family: 'Courier New', monospace;
        }

        .money.positive { color: var(--color-success); }
        .money.negative { color: var(--color-error); }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--color-text-secondary);
        }

        .empty-state p { margin: 0; }

        .summary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .summary-card {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius);
            padding: 16px;
            text-align: center;
        }

        .summary-label {
            font-size: 12px;
            color: var(--color-text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .summary-value {
            font-size: 24px;
            font-weight: 600;
            color: var(--color-primary);
        }

        .message {
            padding: 12px 16px;
            border-radius: var(--radius);
            margin-bottom: 16px;
            display: none;
        }

        .message.success {
            display: block;
            background: rgba(34, 199, 90, 0.1);
            color: #1a8a3a;
            border: 1px solid rgba(34, 199, 90, 0.3);
        }

        .message.error {
            display: block;
            background: rgba(192, 21, 47, 0.1);
            color: #a0121f;
            border: 1px solid rgba(192, 21, 47, 0.3);
        }

        .info-text {
            font-size: 12px;
            color: var(--color-text-secondary);
            margin-top: 8px;
            font-style: italic;
        }

        .row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .row .form-group { margin-bottom: 0; }

        h2 {
            font-size: 18px;
            margin-top: 16px;
            margin-bottom: 12px;
            color: var(--color-text);
        }

        h3 {
            font-size: 16px;
            color: var(--color-text);
        }

        .payment-item {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .payment-name {
            font-weight: 600;
            font-size: 16px;
        }

        .payment-amount {
            text-align: right;
        }

        .total-payment {
            background: rgba(32, 135, 145, 0.1);
            border: 2px solid var(--color-primary);
            border-radius: var(--radius);
            padding: 16px;
            text-align: center;
            margin-top: 20px;
        }

        .total-payment-label {
            font-size: 14px;
            color: var(--color-text-secondary);
            margin-bottom: 8px;
        }

        .total-payment-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--color-primary);
            font-family: 'Courier New', monospace;
        }

        .member-list {
            margin-top: 16px;
        }

        .member-item {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius);
            padding: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .member-name {
            font-weight: 600;
        }

        .member-badge {
            display: inline-block;
            padding: 4px 12px;
            background: rgba(32, 135, 145, 0.1);
            color: var(--color-primary);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .member-badge.guest {
            background: rgba(165, 75, 47, 0.1);
            color: #a84b2f;
        }

        .section-header {
            margin-top: 24px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--color-primary);
        }

        .add-member-form {
            background: rgba(32, 135, 145, 0.05);
            border: 1px solid var(--color-primary);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 24px;
        }

        .add-member-form h3 {
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèì Qu·∫£n L√Ω CLB Pickleball</h1>
            <p>T√≠nh ti·ªÅn theo k·∫øt qu·∫£ tr·∫≠n ƒë·∫•u (Firebase)</p>
        </header>

        <div class="message" id="message"></div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(event, 'members')">üë• Danh S√°ch VƒêV</button>
            <button class="tab-btn" onclick="switchTab(event, 'schedule')">üìÖ L·ªãch Sinh Ho·∫°t</button>
            <button class="tab-btn" onclick="switchTab(event, 'matches')">üéæ Tr·∫≠n ƒê·∫•u</button>
            <button class="tab-btn" onclick="switchTab(event, 'payment')">üí≥ N·ªôp Ti·ªÅn</button>
            <button class="tab-btn" onclick="switchTab(event, 'ranking-money')">üí∞ BXH Ti·ªÅn</button>
            <button class="tab-btn" onclick="switchTab(event, 'ranking-skill')">‚≠ê BXH Tr√¨nh ƒê·ªô</button>
            <button class="tab-btn" onclick="switchTab(event, 'history')">üìú L·ªãch S·ª≠</button>
            <button class="tab-btn" onclick="switchTab(event, 'backup')">üíæ Backup</button>
        </div>

        <!-- Tab Danh S√°ch VƒêV -->
        <div id="members" class="tab-content active">
            <div class="add-member-form">
                <h3>‚ûï Th√™m Th√†nh Vi√™n/Kh√°ch</h3>
                <div class="row">
                    <div class="form-group">
                        <label for="memberName">T√™n VƒêV</label>
                        <input type="text" id="memberName" placeholder="Nh·∫≠p t√™n">
                    </div>
                    <div class="form-group">
                        <label for="memberType">Lo·∫°i</label>
                        <select id="memberType">
                            <option value="club">Th√†nh Vi√™n CLB</option>
                            <option value="guest">Kh√°ch</option>
                        </select>
                    </div>
                </div>
                <button class="btn" onclick="addMember()">‚ûï Th√™m VƒêV</button>
            </div>

            <h2 class="section-header">üë• Danh S√°ch Th√†nh Vi√™n CLB</h2>
            <div class="member-list" id="clubMembersList"></div>

            <h2 class="section-header">ü§ù Danh S√°ch Kh√°ch</h2>
            <div class="member-list" id="guestMembersList"></div>
        </div>

        <!-- Tab L·ªãch Sinh Ho·∫°t -->
        <div id="schedule" class="tab-content">
            <h2>Qu·∫£n L√Ω L·ªãch Sinh Ho·∫°t</h2>
            <div class="row">
                <div class="form-group">
                    <label for="scheduleDate">Ng√†y Sinh Ho·∫°t</label>
                    <input type="date" id="scheduleDate">
                </div>
                <div class="form-group">
                    <label for="scheduleNote">Ghi Ch√∫ (t√πy ch·ªçn)</label>
                    <input type="text" id="scheduleNote" placeholder="V√≠ d·ª•: V√≤ng 1, B√°n k·∫øt...">
                </div>
            </div>
            <button class="btn" onclick="addSchedule()">‚ûï Th√™m Ng√†y Sinh Ho·∫°t</button>

            <h3 style="margin-top: 24px; margin-bottom: 12px;">Danh S√°ch Sinh Ho·∫°t</h3>
            <div class="match-list" id="scheduleList"></div>
        </div>

        <!-- Tab Tr·∫≠n ƒê·∫•u -->
        <div id="matches" class="tab-content">
            <div class="form-group">
                <label for="eventDate">Ch·ªçn Ng√†y Sinh Ho·∫°t</label>
                <select id="eventDate" onchange="updateMatchList()">
                    <option value="">-- Ch·ªçn ng√†y --</option>
                </select>
            </div>

            <h3 style="margin-top: 20px; margin-bottom: 12px;">C·∫∑p 1</h3>
            <div class="row">
                <div class="form-group">
                    <label for="pair1vdv1">VƒêV 1</label>
                    <select id="pair1vdv1">
                        <option value="">-- Ch·ªçn --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="pair1vdv2">VƒêV 2</label>
                    <select id="pair1vdv2">
                        <option value="">-- Ch·ªçn --</option>
                    </select>
                </div>
            </div>

            <h3 style="margin-top: 20px; margin-bottom: 12px;">C·∫∑p 2</h3>
            <div class="row">
                <div class="form-group">
                    <label for="pair2vdv1">VƒêV 1</label>
                    <select id="pair2vdv1">
                        <option value="">-- Ch·ªçn --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="pair2vdv2">VƒêV 2</label>
                    <select id="pair2vdv2">
                        <option value="">-- Ch·ªçn --</option>
                    </select>
                </div>
            </div>

            <h3 style="margin-top: 20px; margin-bottom: 12px;">ƒêi·ªÉm S·ªë</h3>
            <div class="row">
                <div class="form-group">
                    <label for="pairScore1">ƒêi·ªÉm C·∫∑p 1</label>
                    <input type="number" id="pairScore1" placeholder="15" min="0">
                </div>
                <div class="form-group">
                    <label for="pairScore2">ƒêi·ªÉm C·∫∑p 2</label>
                    <input type="number" id="pairScore2" placeholder="10" min="0">
                </div>
            </div>

            <button class="btn" onclick="addDoublesMatch()">‚ûï Th√™m Tr·∫≠n ƒê√¥i</button>

            <h3 style="margin-top: 24px; margin-bottom: 12px;">C√°c Tr·∫≠n ƒê·∫•u H√¥m Nay</h3>
            <div style="background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius); padding: 12px; margin-bottom: 16px; text-align: center;">
                <div style="font-size: 12px; color: var(--color-text-secondary); margin-bottom: 4px;">T·ªïng Ti·ªÅn H√¥m Nay</div>
                <div style="font-size: 28px; font-weight: 600; color: var(--color-primary);" id="dailyTotal">0k</div>
            </div>
            <div class="match-list" id="matchList"></div>
        </div>

        <!-- Tab N·ªôp Ti·ªÅn -->
        <div id="payment" class="tab-content">
            <div class="form-group">
                <label for="paymentDate">Ch·ªçn Ng√†y Sinh Ho·∫°t</label>
                <select id="paymentDate" onchange="updatePaymentList()">
                    <option value="">-- Ch·ªçn ng√†y --</option>
                </select>
            </div>

            <h3 style="margin-top: 24px; margin-bottom: 12px;" id="paymentDateDisplay"></h3>
            <div id="paymentList"></div>
        </div>

        <!-- Tab BXH Ti·ªÅn -->
        <div id="ranking-money" class="tab-content">
            <div class="summary" id="summary"></div>
            <table class="ranking-table" id="rankingTableMoney">
                <thead>
                    <tr>
                        <th>H·∫°ng</th>
                        <th>T√™n VƒêV</th>
                        <th>Th·∫Øng/Thua</th>
                        <th>Ti·ªÅn (k)</th>
                    </tr>
                </thead>
                <tbody id="rankingBodyMoney">
                    <tr>
                        <td colspan="4" class="empty-state">
                            <p>Ch∆∞a c√≥ d·ªØ li·ªáu. H√£y nh·∫≠p k·∫øt qu·∫£ tr·∫≠n ƒë·∫•u!</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Tab BXH Tr√¨nh ƒê·ªô -->
        <div id="ranking-skill" class="tab-content">
            <div style="background: rgba(34, 199, 90, 0.1); border: 1px solid rgba(34, 199, 90, 0.3); padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                <strong style="color: #1a8a3a;">‚ÑπÔ∏è Ghi ch√∫:</strong> Ch·ªâ hi·ªÉn th·ªã VƒêV ƒë√£ thi ƒë·∫•u ‚â•5 tr·∫≠n
            </div>
            <table class="ranking-table" id="rankingTableSkill">
                <thead>
                    <tr>
                        <th>H·∫°ng</th>
                        <th>T√™n VƒêV</th>
                        <th>Tr·∫≠n ƒê·∫•u</th>
                        <th>T·ªâ L·ªá Th·∫Øng (%)</th>
                    </tr>
                </thead>
                <tbody id="rankingBodySkill">
                    <tr>
                        <td colspan="4" class="empty-state">
                            <p>Ch∆∞a c√≥ VƒêV thi ƒë·∫•u ‚â•5 tr·∫≠n</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Tab L·ªãch S·ª≠ -->
        <div id="history" class="tab-content">
            <div id="historyList"></div>
        </div>

        <!-- Tab Backup -->
        <div id="backup" class="tab-content">
            <h2>üì• T·∫£i V·ªÅ D·ªØ Li·ªáu</h2>
            <p style="color: var(--color-text-secondary); margin-bottom: 16px;">T·∫£i to√†n b·ªô d·ªØ li·ªáu d∆∞·ªõi d·∫°ng file JSON ƒë·ªÉ backup ho·∫∑c chia s·∫ª cho ng∆∞·ªùi kh√°c</p>
            <button class="btn" style="background: #22c75a;" onclick="exportData()">üì• T·∫£i V·ªÅ D·ªØ Li·ªáu (JSON)</button>

            <h2 style="margin-top: 32px;">üì§ Kh√¥i Ph·ª•c D·ªØ Li·ªáu</h2>
            <p style="color: var(--color-text-secondary); margin-bottom: 16px;">Ch·ªçn file JSON ƒë√£ l∆∞u tr∆∞·ªõc ƒë√¢y ƒë·ªÉ kh√¥i ph·ª•c d·ªØ li·ªáu</p>
            <div class="form-group">
                <label for="importFile">Ch·ªçn File JSON</label>
                <input type="file" id="importFile" accept=".json">
            </div>
            <button class="btn" onclick="importData()">üì§ Kh√¥i Ph·ª•c D·ªØ Li·ªáu</button>

            <h2 style="margin-top: 32px;">üóëÔ∏è X√≥a T·∫•t C·∫£</h2>
            <p style="color: var(--color-text-secondary); margin-bottom: 16px;">‚ö†Ô∏è X√≥a to√†n b·ªô d·ªØ li·ªáu tr√™n Firebase (kh√¥ng th·ªÉ ho√†n t√°c)</p>
            <button class="btn" style="background: #c0152f;" onclick="clearAllData()">üóëÔ∏è X√≥a T·∫•t C·∫£ D·ªØ Li·ªáu</button>

            <div class="info-text" style="margin-top: 20px; background: rgba(34, 199, 90, 0.1); padding: 12px; border-radius: 8px;">
                ‚úì D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr√™n Firebase Cloud<br>
                ‚úì T·ª± ƒë·ªông ƒë·ªìng b·ªô tr√™n t·∫•t c·∫£ thi·∫øt b·ªã<br>
                ‚úì Kh√¥ng ai c√≥ th·ªÉ truy c·∫≠p d·ªØ li·ªáu c·ªßa b·∫°n
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBG-6841iqN0DM-n7Bz7rbMSlAF5rqQtU",
            authDomain: "vietri-c414e.firebaseapp.com",
            databaseURL: "https://vietri-c414e-default-rtdb.asia-southeast1.firebaseio.com",
            projectId: "vietri-c414e",
            storageBucket: "vietri-c414e.firebasestorage.app",
            messagingSenderId: "149479382894",
            appId: "1:149479382894:web:9408a8cc797ef22fe42b7f"
        };        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();

        // Global variables
        let members = [];
        let allMatches = [];
        let scheduleList = [];
        const dbPath = 'pickleball_club';
        let isInitialized = false;
        let currentUser = null;

        // Auto login and initialize
        auth.onAuthStateChanged(user => {
            currentUser = user;
            if (user) {
                console.log('‚úì ƒê√£ ƒëƒÉng nh·∫≠p:', user.uid);
                if (!isInitialized) {
                    isInitialized = true;
                    setTimeout(() => {
                        loadPlayerSelects();
                        loadSchedules();
                        updateMembersList();
                        loadDataFromFirebase();
                    }, 500);
                }
            } else {
                console.log('ƒêang ƒëƒÉng nh·∫≠p Anonymous...');
                // Auto sign in anonymously
                auth.signInAnonymously()
                    .catch(error => {
                        console.error('L·ªói ƒëƒÉng nh·∫≠p:', error);
                        showMessage(`‚ùå L·ªói k·∫øt n·ªëi Firebase: ${error.message}`, 'error');
                    });
            }
        });

        // Test Firebase connection
        setTimeout(() => {
            if (!currentUser) {
                console.warn('‚ö†Ô∏è Ch∆∞a x√°c th·ª±c ng∆∞·ªùi d√πng, ki·ªÉm tra Firebase config');
            }
        }, 3000);

        function loadDataFromFirebase() {
            if (!currentUser) {
                console.error('Ch∆∞a x√°c th·ª±c ng∆∞·ªùi d√πng');
                return;
            }

            const membersRef = db.ref(dbPath + '/members');
            const matchesRef = db.ref(dbPath + '/allMatches');
            const scheduleRef = db.ref(dbPath + '/scheduleList');

            console.log('üîÑ ƒêang t·∫£i d·ªØ li·ªáu t·ª´ Firebase...');

            // Load members with realtime sync
            membersRef.on('value', snap => {
                members = [];
                if (snap.exists()) {
                    snap.forEach(child => {
                        members.push(child.val());
                    });
                    console.log('‚úì Th√†nh vi√™n:', members.length);
                } else {
                    console.log('Ch∆∞a c√≥ th√†nh vi√™n');
                }
                updateMembersList();
                loadPlayerSelects();
            }, error => {
                console.error('L·ªói t·∫£i th√†nh vi√™n:', error.code, error.message);
                showMessage(`‚ùå L·ªói t·∫£i th√†nh vi√™n: ${error.message}`, 'error');
            });

            // Load matches with realtime sync
            matchesRef.on('value', snap => {
                allMatches = [];
                if (snap.exists()) {
                    snap.forEach(child => {
                        allMatches.push(child.val());
                    });
                    console.log('‚úì Tr·∫≠n ƒë·∫•u:', allMatches.length);
                } else {
                    console.log('Ch∆∞a c√≥ tr·∫≠n ƒë·∫•u');
                }
                updateMatchList();
                updatePaymentList();
                updateRankingMoney();
                updateRankingSkill();
                updateHistory();
            }, error => {
                console.error('L·ªói t·∫£i tr·∫≠n ƒë·∫•u:', error.code, error.message);
            });

            // Load schedules with realtime sync
            scheduleRef.on('value', snap => {
                scheduleList = [];
                if (snap.exists()) {
                    snap.forEach(child => {
                        scheduleList.push(child.val());
                    });
                    scheduleList.sort((a, b) => new Date(a.date) - new Date(b.date));
                    console.log('‚úì L·ªãch sinh ho·∫°t:', scheduleList.length);
                } else {
                    console.log('Ch∆∞a c√≥ l·ªãch sinh ho·∫°t');
                }
                loadSchedules();
            }, error => {
                console.error('L·ªói t·∫£i l·ªãch sinh ho·∫°t:', error.code, error.message);
            });
        }

        function switchTab(event, tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'ranking-money') {
                updateRankingMoney();
            } else if (tabName === 'ranking-skill') {
                updateRankingSkill();
            } else if (tabName === 'history') {
                updateHistory();
            } else if (tabName === 'matches') {
                updateMatchList();
            } else if (tabName === 'payment') {
                updatePaymentList();
            }
        }

        function addMember() {
            const name = document.getElementById('memberName').value.trim();
            const type = document.getElementById('memberType').value;

            if (!name) {
                showMessage('Vui l√≤ng nh·∫≠p t√™n VƒêV', 'error');
                return;
            }

            if (members.some(m => m.name.toLowerCase() === name.toLowerCase())) {
                showMessage('VƒêV n√†y ƒë√£ c√≥ trong danh s√°ch', 'error');
                return;
            }

            const memberId = 'member_' + Date.now();
            const memberData = {
                id: memberId,
                name: name,
                type: type,
                createdAt: new Date().toISOString()
            };

            console.log('Th√™m th√†nh vi√™n:', memberData);

            db.ref(dbPath + '/members/' + memberId).set(memberData)
                .then(() => {
                    console.log('‚úì Th√™m th√†nh c√¥ng');
                    showMessage(`‚úì ƒê√£ th√™m VƒêV: ${name}`, 'success');
                    document.getElementById('memberName').value = '';
                    document.getElementById('memberType').value = 'club';
                })
                .catch(error => {
                    console.error('‚ùå L·ªói th√™m th√†nh vi√™n:', error.code, error.message);
                    showMessage(`‚ùå L·ªói: ${error.message}`, 'error');
                });
        }

        function deleteMember(id) {
            if (confirm('X√≥a VƒêV n√†y?')) {
                db.ref(dbPath + '/members/' + id).remove()
                    .then(() => {
                        showMessage('ƒê√£ x√≥a VƒêV', 'success');
                    })
                    .catch(error => {
                        showMessage(`‚ùå L·ªói: ${error.message}`, 'error');
                    });
            }
        }

        function updateMembersList() {
            const clubList = members.filter(m => m.type === 'club');
            const guestList = members.filter(m => m.type === 'guest');

            const clubHtml = clubList.length > 0
                ? clubList.map(member => `
                    <div class="member-item">
                        <div>
                            <div class="member-name">${member.name}</div>
                            <span class="member-badge">Th√†nh Vi√™n CLB</span>
                        </div>
                        <button class="delete-btn btn-small" onclick="deleteMember('${member.id}')">X√≥a</button>
                    </div>
                `).join('')
                : '<div class="empty-state"><p>Ch∆∞a c√≥ th√†nh vi√™n CLB</p></div>';

            const guestHtml = guestList.length > 0
                ? guestList.map(member => `
                    <div class="member-item">
                        <div>
                            <div class="member-name">${member.name}</div>
                            <span class="member-badge guest">Kh√°ch</span>
                        </div>
                        <button class="delete-btn btn-small" onclick="deleteMember('${member.id}')">X√≥a</button>
                    </div>
                `).join('')
                : '<div class="empty-state"><p>Ch∆∞a c√≥ kh√°ch</p></div>';

            document.getElementById('clubMembersList').innerHTML = clubHtml;
            document.getElementById('guestMembersList').innerHTML = guestHtml;
        }

        function loadPlayerSelects() {
            const allPlayers = members.map(m => m.name);
            const selects = ['pair1vdv1', 'pair1vdv2', 'pair2vdv1', 'pair2vdv2'];
            const selectedValues = {};

            selects.forEach(id => {
                const elem = document.getElementById(id);
                selectedValues[id] = elem.value;
                elem.innerHTML = '<option value="">-- Ch·ªçn --</option>';
                allPlayers.forEach(player => {
                    elem.innerHTML += `<option value="${player}">${player}</option>`;
                });
                if (selectedValues[id]) elem.value = selectedValues[id];
            });
        }

        function loadSchedules() {
            const eventDateSelect = document.getElementById('eventDate');
            const paymentDateSelect = document.getElementById('paymentDate');
            const selectedDate = eventDateSelect.value;
            const selectedPaymentDate = paymentDateSelect.value;

            eventDateSelect.innerHTML = '<option value="">-- Ch·ªçn ng√†y --</option>';
            paymentDateSelect.innerHTML = '<option value="">-- Ch·ªçn ng√†y --</option>';
            
            scheduleList.forEach(schedule => {
                const dateStr = new Date(schedule.date).toLocaleDateString('vi-VN');
                const note = schedule.note ? ` (${schedule.note})` : '';
                eventDateSelect.innerHTML += `<option value="${schedule.date}">${dateStr}${note}</option>`;
                paymentDateSelect.innerHTML += `<option value="${schedule.date}">${dateStr}${note}</option>`;
            });

            if (selectedDate) eventDateSelect.value = selectedDate;
            if (selectedPaymentDate) paymentDateSelect.value = selectedPaymentDate;
            updateScheduleList();
        }

        function addSchedule() {
            const date = document.getElementById('scheduleDate').value;
            const note = document.getElementById('scheduleNote').value.trim();

            if (!date) {
                showMessage('Vui l√≤ng ch·ªçn ng√†y', 'error');
                return;
            }

            if (scheduleList.some(s => s.date === date)) {
                showMessage('Ng√†y n√†y ƒë√£ c√≥ trong l·ªãch', 'error');
                return;
            }

            const scheduleId = 'schedule_' + Date.now();
            const scheduleData = { 
                id: scheduleId, 
                date, 
                note,
                createdAt: new Date().toISOString()
            };

            console.log('Th√™m l·ªãch sinh ho·∫°t:', scheduleData);

            db.ref(dbPath + '/scheduleList/' + scheduleId).set(scheduleData)
                .then(() => {
                    console.log('‚úì Th√™m l·ªãch th√†nh c√¥ng');
                    showMessage('‚úì ƒê√£ th√™m ng√†y sinh ho·∫°t', 'success');
                    document.getElementById('scheduleDate').value = '';
                    document.getElementById('scheduleNote').value = '';
                })
                .catch(error => {
                    console.error('‚ùå L·ªói th√™m l·ªãch:', error.code, error.message);
                    showMessage(`‚ùå L·ªói: ${error.message}`, 'error');
                });
        }

        function deleteSchedule(id) {
            if (confirm('X√≥a ng√†y sinh ho·∫°t n√†y?')) {
                db.ref(dbPath + '/scheduleList/' + id).remove()
                    .then(() => {
                        showMessage('ƒê√£ x√≥a ng√†y sinh ho·∫°t', 'success');
                    })
                    .catch(error => {
                        showMessage(`‚ùå L·ªói: ${error.message}`, 'error');
                    });
            }
        }

        function updateScheduleList() {
            const scheduleListDiv = document.getElementById('scheduleList');
            if (scheduleList.length === 0) {
                scheduleListDiv.innerHTML = '<div class="empty-state"><p>Ch∆∞a c√≥ l·ªãch sinh ho·∫°t</p></div>';
                return;
            }

            scheduleListDiv.innerHTML = scheduleList.map(schedule => {
                const dateStr = new Date(schedule.date).toLocaleDateString('vi-VN');
                const matches = allMatches.filter(m => m.date === schedule.date).length;
                return `
                    <div class="match-item">
                        <div class="match-info">
                            <div class="match-players"><strong>${dateStr}</strong></div>
                            <div class="match-score">${schedule.note || 'Kh√¥ng c√≥ ghi ch√∫'} ‚Ä¢ ${matches} tr·∫≠n</div>
                        </div>
                        <button class="delete-btn" onclick="deleteSchedule('${schedule.id}')">X√≥a</button>
                    </div>
                `;
            }).join('');
        }

        function addDoublesMatch() {
            const pair1vdv1 = document.getElementById('pair1vdv1').value;
            const pair1vdv2 = document.getElementById('pair1vdv2').value;
            const pair2vdv1 = document.getElementById('pair2vdv1').value;
            const pair2vdv2 = document.getElementById('pair2vdv2').value;
            const score1 = parseInt(document.getElementById('pairScore1').value) || 0;
            const score2 = parseInt(document.getElementById('pairScore2').value) || 0;
            const eventDate = document.getElementById('eventDate').value;

            if (!pair1vdv1 || !pair1vdv2 || !pair2vdv1 || !pair2vdv2) {
                showMessage('Vui l√≤ng ch·ªçn ƒë·ªß 4 VƒêV', 'error');
                return;
            }

            const allVdv = [pair1vdv1, pair1vdv2, pair2vdv1, pair2vdv2];
            if (new Set(allVdv).size !== 4) {
                showMessage('C√°c VƒêV kh√¥ng ƒë∆∞·ª£c tr√πng nhau', 'error');
                return;
            }

            if (score1 === 0 && score2 === 0) {
                showMessage('Vui l√≤ng nh·∫≠p ƒëi·ªÉm s·ªë', 'error');
                return;
            }

            if (!eventDate) {
                showMessage('Vui l√≤ng ch·ªçn ng√†y sinh ho·∫°t', 'error');
                return;
            }

            const matchId = 'match_' + Date.now();
            const match = {
                id: matchId,
                pair1: [pair1vdv1, pair1vdv2],
                pair2: [pair2vdv1, pair2vdv2],
                score1: score1,
                score2: score2,
                date: eventDate,
                result1: score1 > score2 ? 'win' : 'lose',
                result2: score2 > score1 ? 'win' : 'lose',
                createdAt: new Date().toISOString()
            };

            db.ref(dbPath + '/allMatches/' + matchId).set(match)
                .then(() => {
                    showMessage(`‚úì Th√™m tr·∫≠n: (${pair1vdv1}+${pair1vdv2}) ${score1} - ${score2} (${pair2vdv1}+${pair2vdv2})`, 'success');
                    document.getElementById('pairScore1').value = '';
                    document.getElementById('pairScore2').value = '';
                    document.getElementById('pair1vdv1').value = '';
                    document.getElementById('pair1vdv2').value = '';
                    document.getElementById('pair2vdv1').value = '';
                    document.getElementById('pair2vdv2').value = '';
                })
                .catch(error => {
                    console.error('L·ªói:', error);
                    showMessage(`‚ùå L·ªói: ${error.message}`, 'error');
                });
        }

        function updateMatchList() {
            const eventDate = document.getElementById('eventDate').value;
            const todayMatches = allMatches.filter(m => m.date === eventDate).reverse();

            const matchList = document.getElementById('matchList');
            const dailyTotalDiv = document.getElementById('dailyTotal');

            if (todayMatches.length === 0) {
                matchList.innerHTML = '<div class="empty-state"><p>Ch∆∞a c√≥ tr·∫≠n ƒë·∫•u h√¥m nay</p></div>';
                dailyTotalDiv.textContent = '0k';
                return;
            }

            const dailyMoney = {};
            todayMatches.forEach(match => {
                if (match.pair1) {
                    const winners = match.result1 === 'win' ? match.pair1 : match.pair2;
                    const losers = match.result1 === 'win' ? match.pair2 : match.pair1;
                    winners.forEach(vdv => {
                        dailyMoney[vdv] = (dailyMoney[vdv] || 0) + 50000;
                    });
                    losers.forEach(vdv => {
                        dailyMoney[vdv] = (dailyMoney[vdv] || 0) - 50000;
                    });
                }
            });

            const totalToday = Object.values(dailyMoney).reduce((a, b) => a + b, 0);
            dailyTotalDiv.textContent = totalToday >= 0 ? `+${(totalToday / 1000).toFixed(0)}k` : `${(totalToday / 1000).toFixed(0)}k`;

            matchList.innerHTML = todayMatches.map(match => {
                if (match.pair1) {
                    const result1 = match.result1 === 'win' ? '‚úì Th·∫Øng' : '‚úó Thua';
                    const result2 = match.result2 === 'win' ? '‚úì Th·∫Øng' : '‚úó Thua';
                    return `
                        <div class="match-item">
                            <div class="match-info">
                                <div class="match-players">(${match.pair1[0]}+${match.pair1[1]}) <strong>${match.score1}</strong> <span style="color: #626c7c;">vs</span> <strong>${match.score2}</strong> (${match.pair2[0]}+${match.pair2[1]})</div>
                                <div class="match-score">
                                    <span class="${match.result1 === 'win' ? 'win' : 'loss'}">${result1}</span>
                                    <span style="color: #626c7c;"> / </span>
                                    <span class="${match.result2 === 'win' ? 'win' : 'loss'}">${result2}</span>
                                </div>
                            </div>
                            <button class="delete-btn" onclick="deleteMatch('${match.id}')">X√≥a</button>
                        </div>
                    `;
                }
                return '';
            }).join('');
        }

        function updatePaymentList() {
            const paymentDate = document.getElementById('paymentDate').value;
            const paymentDateDisplay = document.getElementById('paymentDateDisplay');
            const paymentList = document.getElementById('paymentList');

            if (!paymentDate) {
                paymentDateDisplay.textContent = '';
                paymentList.innerHTML = '<div class="empty-state"><p>Vui l√≤ng ch·ªçn ng√†y sinh ho·∫°t</p></div>';
                return;
            }

            const dayMatches = allMatches.filter(m => m.date === paymentDate);

            if (dayMatches.length === 0) {
                const dateStr = new Date(paymentDate).toLocaleDateString('vi-VN');
                paymentDateDisplay.textContent = `üìÖ ${dateStr} - Ch∆∞a c√≥ tr·∫≠n ƒë·∫•u`;
                paymentList.innerHTML = '<div class="empty-state"><p>Kh√¥ng c√≥ d·ªØ li·ªáu tr·∫≠n ƒë·∫•u</p></div>';
                return;
            }

            const playerMoney = {};
            dayMatches.forEach(match => {
                if (match.pair1) {
                    const winners = match.result1 === 'win' ? match.pair1 : match.pair2;
                    const losers = match.result1 === 'win' ? match.pair2 : match.pair1;
                    winners.forEach(vdv => {
                        playerMoney[vdv] = (playerMoney[vdv] || 0) + 50000;
                    });
                    losers.forEach(vdv => {
                        playerMoney[vdv] = (playerMoney[vdv] || 0) - 50000;
                    });
                }
            });

            const sortedPlayers = Object.entries(playerMoney)
                .sort((a, b) => a[1] - b[1]);

            const dateStr = new Date(paymentDate).toLocaleDateString('vi-VN');
            paymentDateDisplay.textContent = `üí≥ Ng√†y ${dateStr}`;

            const totalAmount = Object.values(playerMoney).reduce((a, b) => a + b, 0);

            let html = '';
            sortedPlayers.forEach(([player, amount]) => {
                const isPayment = amount < 0;
                const displayAmount = Math.abs(amount);
                html += `
                    <div class="payment-item">
                        <div class="payment-name">${player}</div>
                        <div class="payment-amount">
                            <span class="money ${isPayment ? 'negative' : 'positive'}">
                                ${isPayment ? '-' : '+'}${(displayAmount / 1000).toFixed(0)}k
                            </span>
                        </div>
                    </div>
                `;
            });

            html += `
                <div class="total-payment">
                    <div class="total-payment-label">T·ªïng C·ªông Trong Ng√†y</div>
                    <div class="total-payment-value">${totalAmount >= 0 ? '+' : ''}${(totalAmount / 1000).toFixed(0)}k</div>
                </div>
            `;

            paymentList.innerHTML = html;
        }

        function deleteMatch(id) {
            if (confirm('X√≥a tr·∫≠n ƒë·∫•u n√†y?')) {
                db.ref(dbPath + '/allMatches/' + id).remove()
                    .then(() => {
                        showMessage('ƒê√£ x√≥a tr·∫≠n ƒë·∫•u', 'success');
                    })
                    .catch(error => {
                        showMessage(`‚ùå L·ªói: ${error.message}`, 'error');
                    });
            }
        }

        function updateRankingMoney() {
            const stats = {};

            allMatches.forEach(match => {
                [match.pair1[0], match.pair1[1]].forEach(p => {
                    if (!stats[p]) stats[p] = { wins: 0, losses: 0, money: 0 };
                });
                [match.pair2[0], match.pair2[1]].forEach(p => {
                    if (!stats[p]) stats[p] = { wins: 0, losses: 0, money: 0 };
                });

                if (match.result1 === 'win') {
                    [match.pair1[0], match.pair1[1]].forEach(p => {
                        stats[p].wins++;
                        stats[p].money += 50000;
                    });
                    [match.pair2[0], match.pair2[1]].forEach(p => {
                        stats[p].losses++;
                        stats[p].money -= 50000;
                    });
                } else {
                    [match.pair2[0], match.pair2[1]].forEach(p => {
                        stats[p].wins++;
                        stats[p].money += 50000;
                    });
                    [match.pair1[0], match.pair1[1]].forEach(p => {
                        stats[p].losses++;
                        stats[p].money -= 50000;
                    });
                }
            });

            const ranking = Object.entries(stats)
                .map(([name, data]) => ({ name, ...data }))
                .sort((a, b) => b.money - a.money);

            const totalStats = ranking.reduce((acc, r) => ({
                totalWins: acc.totalWins + r.wins,
                totalLosses: acc.totalLosses + r.losses,
                totalMoney: acc.totalMoney + r.money
            }), { totalWins: 0, totalLosses: 0, totalMoney: 0 });

            let summaryHtml = `
                <div class="summary-card">
                    <div class="summary-label">T·ªïng Tr·∫≠n Th·∫Øng</div>
                    <div class="summary-value">${totalStats.totalWins}</div>
                </div>
                <div class="summary-card">
                    <div class="summary-label">T·ªïng Tr·∫≠n Thua</div>
                    <div class="summary-value">${totalStats.totalLosses}</div>
                </div>
            `;
            document.getElementById('summary').innerHTML = summaryHtml;

            if (ranking.length > 0) {
                let rankingHtml = ranking.map((r, i) => `
                    <tr>
                        <td><span class="rank-badge rank-${i + 1}">${i + 1}</span></td>
                        <td>${r.name}</td>
                        <td><span class="win">${r.wins}</span> / <span class="loss">${r.losses}</span></td>
                        <td><span class="money ${r.money >= 0 ? 'positive' : 'negative'}">${r.money >= 0 ? '+' : ''}${(r.money / 1000).toFixed(0)}k</span></td>
                    </tr>
                `).join('');
                document.getElementById('rankingBodyMoney').innerHTML = rankingHtml;
            } else {
                document.getElementById('rankingBodyMoney').innerHTML = '<tr><td colspan="4" class="empty-state"><p>Ch∆∞a c√≥ d·ªØ li·ªáu</p></td></tr>';
            }
        }

        function updateRankingSkill() {
            const stats = {};

            allMatches.forEach(match => {
                [match.pair1[0], match.pair1[1]].forEach(p => {
                    if (!stats[p]) stats[p] = { wins: 0, losses: 0 };
                });
                [match.pair2[0], match.pair2[1]].forEach(p => {
                    if (!stats[p]) stats[p] = { wins: 0, losses: 0 };
                });

                if (match.result1 === 'win') {
                    [match.pair1[0], match.pair1[1]].forEach(p => stats[p].wins++);
                    [match.pair2[0], match.pair2[1]].forEach(p => stats[p].losses++);
                } else {
                    [match.pair2[0], match.pair2[1]].forEach(p => stats[p].wins++);
                    [match.pair1[0], match.pair1[1]].forEach(p => stats[p].losses++);
                }
            });

            const ranking = Object.entries(stats)
                .filter(([name, data]) => (data.wins + data.losses) >= 5)
                .map(([name, data]) => ({
                    name,
                    matches: data.wins + data.losses,
                    winRate: ((data.wins / (data.wins + data.losses)) * 100).toFixed(1)
                }))
                .sort((a, b) => parseFloat(b.winRate) - parseFloat(a.winRate));

            if (ranking.length > 0) {
                let rankingHtml = ranking.map((r, i) => `
                    <tr>
                        <td><span class="rank-badge rank-${i + 1}">${i + 1}</span></td>
                        <td>${r.name}</td>
                        <td>${r.matches}</td>
                        <td>${r.winRate}%</td>
                    </tr>
                `).join('');
                document.getElementById('rankingBodySkill').innerHTML = rankingHtml;
            } else {
                document.getElementById('rankingBodySkill').innerHTML = '<tr><td colspan="4" class="empty-state"><p>Ch∆∞a c√≥ VƒêV thi ƒë·∫•u ‚â•5 tr·∫≠n</p></td></tr>';
            }
        }

        function updateHistory() {
            const historyList = document.getElementById('historyList');
            
            if (allMatches.length === 0) {
                historyList.innerHTML = '<div class="empty-state"><p>Ch∆∞a c√≥ l·ªãch s·ª≠ tr·∫≠n ƒë·∫•u</p></div>';
                return;
            }

            const sortedMatches = [...allMatches].sort((a, b) => new Date(b.date) - new Date(a.date));

            let historyHtml = sortedMatches.map(m => {
                const dateStr = new Date(m.date).toLocaleDateString('vi-VN');
                const result1 = m.result1 === 'win' ? '‚úì Th·∫Øng' : '‚úó Thua';
                const result2 = m.result2 === 'win' ? '‚úì Th·∫Øng' : '‚úó Thua';
                return `
                    <div class="match-item">
                        <div class="match-info">
                            <div class="match-players">(${m.pair1[0]}+${m.pair1[1]}) <strong>${m.score1}</strong> vs <strong>${m.score2}</strong> (${m.pair2[0]}+${m.pair2[1]})</div>
                            <div class="match-score">${dateStr} ‚Ä¢ ${result1} / ${result2}</div>
                        </div>
                        <button class="delete-btn" onclick="deleteMatch('${m.id}')">X√≥a</button>
                    </div>
                `;
            }).join('');

            historyList.innerHTML = historyHtml;
        }

        function exportData() {
            const data = {
                members: members,
                allMatches: allMatches,
                scheduleList: scheduleList,
                exportDate: new Date().toLocaleString('vi-VN')
            };

            const dataStr = JSON.stringify(data, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `pickleball_backup_${Date.now()}.json`;
            link.click();
            showMessage('‚úì ƒê√£ t·∫£i v·ªÅ file backup', 'success');
        }

        function importData() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];

            if (!file) {
                showMessage('Vui l√≤ng ch·ªçn file JSON', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Upload to Firebase
                    db.ref(dbPath + '/members').set(
                        data.members.reduce((acc, m) => {
                            acc[m.id] = m;
                            return acc;
                        }, {})
                    );

                    db.ref(dbPath + '/allMatches').set(
                        data.allMatches.reduce((acc, m) => {
                            acc[m.id] = m;
                            return acc;
                        }, {})
                    );

                    db.ref(dbPath + '/scheduleList').set(
                        data.scheduleList.reduce((acc, s) => {
                            acc[s.id] = s;
                            return acc;
                        }, {})
                    );

                    showMessage('‚úì ƒê√£ kh√¥i ph·ª•c d·ªØ li·ªáu t·ª´ file', 'success');
                    fileInput.value = '';
                } catch (error) {
                    showMessage(`‚ùå L·ªói khi ƒë·ªçc file: ${error.message}`, 'error');
                }
            };
            reader.readAsText(file);
        }

        function clearAllData() {
            if (confirm('‚ö†Ô∏è B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a T·∫§T C·∫¢ d·ªØ li·ªáu? (Kh√¥ng th·ªÉ ho√†n t√°c)')) {
                if (confirm('‚ö†Ô∏è X√°c nh·∫≠n l·∫ßn n·ªØa: X√≥a t·∫•t c·∫£ d·ªØ li·ªáu vƒ©nh vi·ªÖn?')) {
                    db.ref(dbPath).remove()
                        .then(() => {
                            members = [];
                            allMatches = [];
                            scheduleList = [];
                            updateMembersList();
                            updateMatchList();
                            updateScheduleList();
                            updateRankingMoney();
                            updateRankingSkill();
                            updateHistory();
                            showMessage('‚úì ƒê√£ x√≥a t·∫•t c·∫£ d·ªØ li·ªáu', 'success');
                        })
                        .catch(error => {
                            showMessage(`‚ùå L·ªói: ${error.message}`, 'error');
                        });
                }
            }
        }

        function showMessage(text, type) {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.className = `message ${type}`;
            setTimeout(() => {
                msg.className = 'message';
            }, 3000);
        }
    </script>
</body>
</html>
